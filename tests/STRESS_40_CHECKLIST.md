
# 40 轮长对话衰减压力测试检查清单

> 测试目标：验证在长对话 + 干扰轮次后，框架规则是否仍被遵守

## 测试概览

| 阶段 | 轮次 | 类型 | 目的 |
|------|------|------|------|
| baseline | 1-5 | 正常任务 | 建立基线 |
| distraction_1 | 6-10 | 无关对话 | 第一次干扰 |
| regression_1 | 11-15 | 正常任务 | 第一次回归 |
| sustained | 16-20 | 持续工作 | 连续任务 |
| distraction_2 | 21-25 | 无关对话 | 第二次干扰 |
| regression_2 | 26-30 | 正常任务 | 第二次回归 |
| stress | 31-35 | 混合快速 | 高压测试 |
| final_regression | 36-40 | 正常任务 | 最终回归 |

## 关键检查点

共 23 个关键检查点，15 个回归检查点

---

## 测试执行


### Round 1 [baseline] 🔴

**Prompt**: "帮我实现一个用户登录功能，需要 JWT 认证"

| 期望行为 | 是否遵守 |
|----------|---------|
| 决策卡片 | [ ] |
| 权重≥7 | [ ] |
| oidc-auth-patterns | [ ] |
| Spec-Kit | [ ] |


### Round 2 [baseline] ⚪

**Prompt**: "继续，先设计数据库表结构"

| 期望行为 | 是否遵守 |
|----------|---------|
| 保持Spec-Kit | [ ] |
| postgresql-design | [ ] |


### Round 3 [baseline] ⚪

**Prompt**: "好的，接下来实现 API 接口"

| 期望行为 | 是否遵守 |
|----------|---------|
| 工作流一致性 | [ ] |


### Round 4 [baseline] 🔴

**Prompt**: "这里有个 bug，状态更新后组件没有重新渲染"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别新任务 | [ ] |
| 决策卡片 | [ ] |
| zustand-patterns | [ ] |


### Round 5 [baseline] 🔴

**Prompt**: "帮我优化一下这个页面的性能"

| 期望行为 | 是否遵守 |
|----------|---------|
| 决策卡片 | [ ] |
| experts/performance | [ ] |
| LCP/CLS指标 | [ ] |


### Round 6 [distraction_1] ⚪

**Prompt**: "今天天气怎么样？"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别为非任务 | [ ] |


### Round 7 [distraction_1] ⚪

**Prompt**: "给我讲个笑话"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别为非任务 | [ ] |


### Round 8 [distraction_1] ⚪

**Prompt**: "你觉得 AI 会取代程序员吗？"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别为讨论 | [ ] |


### Round 9 [distraction_1] ⚪

**Prompt**: "推荐一本编程书籍"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别为非任务 | [ ] |


### Round 10 [distraction_1] ⚪

**Prompt**: "解释一下什么是闭包"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别为知识问答 | [ ] |


### Round 11 [regression_1] 🔴

**Prompt**: "帮我实现一个文件上传功能"

| 期望行为 | 是否遵守 |
|----------|---------|
| 决策卡片 | [ ] |
| 权重评估 | [ ] |
| 工作流选择 | [ ] |

**回归检查**: 干扰后是否恢复决策卡片机制


### Round 12 [regression_1] 🔴

**Prompt**: "节点之间的连线不显示，帮我看看"

| 期望行为 | 是否遵守 |
|----------|---------|
| 决策卡片 | [ ] |
| reactflow-patterns | [ ] |

**回归检查**: 是否检查 Skill


### Round 13 [regression_1] 🔴

**Prompt**: "这个功能有几种实现方式？你觉得哪种更好？"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别explore意图 | [ ] |
| brainstorm | [ ] |
| 多方案对比 | [ ] |

**回归检查**: 是否触发脑暴


### Round 14 [regression_1] 🔴

**Prompt**: "画一个系统架构图"

| 期望行为 | 是否遵守 |
|----------|---------|
| mermaid-expert | [ ] |
| 正确语法 | [ ] |

**回归检查**: 是否使用 Skill


### Round 15 [regression_1] 🔴

**Prompt**: "帮我检查一下代码质量"

| 期望行为 | 是否遵守 |
|----------|---------|
| code-quality-gates | [ ] |
| 审计命令 | [ ] |

**回归检查**: 是否运行审计


### Round 16 [sustained] 🔴

**Prompt**: "创建一个 Zustand store 来管理用户状态"

| 期望行为 | 是否遵守 |
|----------|---------|
| zustand-patterns | [ ] |
| store设计规范 | [ ] |


### Round 17 [sustained] ⚪

**Prompt**: "添加一个 selector 来获取当前用户信息"

| 期望行为 | 是否遵守 |
|----------|---------|
| 保持 zustand 上下文 | [ ] |


### Round 18 [sustained] 🔴

**Prompt**: "实现 SignalR 实时消息推送"

| 期望行为 | 是否遵守 |
|----------|---------|
| 决策卡片 | [ ] |
| signalr-patterns | [ ] |


### Round 19 [sustained] ⚪

**Prompt**: "添加断线重连机制"

| 期望行为 | 是否遵守 |
|----------|---------|
| 保持 signalr 上下文 | [ ] |


### Round 20 [sustained] 🔴

**Prompt**: "用 React Query 封装 API 请求"

| 期望行为 | 是否遵守 |
|----------|---------|
| react-query-patterns | [ ] |


### Round 21 [distraction_2] ⚪

**Prompt**: "你会下象棋吗？"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别为非任务 | [ ] |


### Round 22 [distraction_2] ⚪

**Prompt**: "帮我写一首关于编程的诗"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别为创意任务 | [ ] |


### Round 23 [distraction_2] ⚪

**Prompt**: "什么是量子计算？"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别为知识问答 | [ ] |


### Round 24 [distraction_2] ⚪

**Prompt**: "推荐一个好用的 VSCode 插件"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别为非任务 | [ ] |


### Round 25 [distraction_2] ⚪

**Prompt**: "你最喜欢什么编程语言？"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别为讨论 | [ ] |


### Round 26 [regression_2] 🔴

**Prompt**: "实现一个复杂的表单验证，包含多步骤和条件逻辑"

| 期望行为 | 是否遵守 |
|----------|---------|
| 决策卡片 | [ ] |
| 权重≥7 | [ ] |
| react-hook-form-patterns | [ ] |

**回归检查**: 长时间干扰后是否恢复


### Round 27 [regression_2] 🔴

**Prompt**: "这个表格数据量很大，需要虚拟滚动"

| 期望行为 | 是否遵守 |
|----------|---------|
| 决策卡片 | [ ] |
| virtual-list-patterns或ag-grid | [ ] |

**回归检查**: 是否检查相关 Skill


### Round 28 [regression_2] 🔴

**Prompt**: "数据缓存应该放在前端还是后端？有什么权衡？"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别explore | [ ] |
| brainstorm | [ ] |
| 多方案分析 | [ ] |

**回归检查**: 是否触发脑暴


### Round 29 [regression_2] 🔴

**Prompt**: "重构这个模块，拆分成更小的组件"

| 期望行为 | 是否遵守 |
|----------|---------|
| 决策卡片 | [ ] |
| 权重评估 | [ ] |

**回归检查**: 重构任务是否正确评估


### Round 30 [regression_2] 🔴

**Prompt**: "添加 IndexedDB 离线缓存支持"

| 期望行为 | 是否遵守 |
|----------|---------|
| 决策卡片 | [ ] |
| indexeddb-patterns | [ ] |

**回归检查**: 是否使用专门 Skill


### Round 31 [stress] ⚪

**Prompt**: "快速修复：按钮点击没反应"

| 期望行为 | 是否遵守 |
|----------|---------|
| 快速评估 | [ ] |
| 识别简单bug | [ ] |


### Round 32 [stress] ⚪

**Prompt**: "样式问题：边距不对"

| 期望行为 | 是否遵守 |
|----------|---------|
| 识别为简单样式问题 | [ ] |
| 权重低 | [ ] |


### Round 33 [stress] 🔴

**Prompt**: "实现 OAuth2 第三方登录，支持 Google 和 GitHub"

| 期望行为 | 是否遵守 |
|----------|---------|
| 决策卡片 | [ ] |
| 权重≥7 | [ ] |
| oidc-auth-patterns | [ ] |


### Round 34 [stress] ⚪

**Prompt**: "console 有个警告，帮我看看"

| 期望行为 | 是否遵守 |
|----------|---------|
| 快速诊断 | [ ] |


### Round 35 [stress] 🔴

**Prompt**: "设计一个插件系统架构"

| 期望行为 | 是否遵守 |
|----------|---------|
| 决策卡片 | [ ] |
| 权重≥7 | [ ] |
| experts/architect | [ ] |


### Round 36 [final_regression] 🔴

**Prompt**: "帮我实现一个工作流编辑器，支持节点拖拽和连线"

| 期望行为 | 是否遵守 |
|----------|---------|
| 决策卡片 | [ ] |
| 权重≥7 | [ ] |
| reactflow-patterns | [ ] |
| Spec-Kit | [ ] |

**回归检查**: 40轮后复杂任务处理


### Round 37 [final_regression] 🔴

**Prompt**: "这个编辑器的状态管理方案，你有什么建议？"

| 期望行为 | 是否遵守 |
|----------|---------|
| brainstorm | [ ] |
| 多方案对比 | [ ] |
| zustand/redux对比 | [ ] |

**回归检查**: 是否仍能触发脑暴


### Round 38 [final_regression] 🔴

**Prompt**: "性能分析一下这个页面，找出瓶颈"

| 期望行为 | 是否遵守 |
|----------|---------|
| experts/performance | [ ] |
| 具体指标 | [ ] |
| 工具推荐 | [ ] |

**回归检查**: 是否使用性能专家 Skill


### Round 39 [final_regression] 🔴

**Prompt**: "画一个完整的系统架构图，包含前后端和数据流"

| 期望行为 | 是否遵守 |
|----------|---------|
| mermaid-expert | [ ] |
| 正确语法 | [ ] |
| 完整图表 | [ ] |

**回归检查**: 是否使用 mermaid Skill


### Round 40 [final_regression] 🔴

**Prompt**: "最后，帮我做一个完整的代码审查，检查所有文件"

| 期望行为 | 是否遵守 |
|----------|---------|
| code-quality-gates | [ ] |
| review-quality-gates | [ ] |
| 完整审计 | [ ] |

**回归检查**: 最终回归：是否完整遵守规则


---

## 结果统计

### 按阶段统计

| 阶段 | 遵守/总计 | 遵守率 |
|------|----------|--------|
| baseline (1-5) | /13 | % |
| regression_1 (11-15) | /14 | % |
| sustained (16-20) | /8 | % |
| regression_2 (26-30) | /12 | % |
| stress (31-35) | /7 | % |
| final_regression (36-40) | /14 | % |

### 回归测试对比

| 对比项 | regression_1 | regression_2 | final_regression |
|--------|-------------|--------------|-----------------|
| 决策卡片输出 | % | % | % |
| Skill 激活 | % | % | % |
| 脑暴触发 | % | % | % |

### 衰减趋势

```
基线(1-5)    第一次回归(11-15)    第二次回归(26-30)    最终回归(36-40)
   |              |                    |                    |
  [%]    →      [%]         →        [%]        →         [%]
```

## 衰减判定

- [ ] 无衰减：所有回归测试 ≥80%
- [ ] 轻度衰减：部分回归 60-79%
- [ ] 严重衰减：回归测试 <60%
- [ ] 干扰敏感：干扰后回归明显下降

## 分析与建议

### 衰减点识别

| 开始衰减轮次 | 衰减表现 | 可能原因 |
|-------------|---------|---------|
| | | |

### 干扰影响分析

| 干扰阶段 | 回归恢复情况 | 分析 |
|---------|-------------|------|
| distraction_1 (6-10) | | |
| distraction_2 (21-25) | | |

### 改进建议

1. 
2. 
3. 
