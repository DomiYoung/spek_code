# 工具选择决策指南

四套工具的**分层互补**架构，根据任务特征自动组合使用。

> 🎯 **零命令架构**: 用户无需记忆任何命令，直接描述任务即可。

---

## 🚨 关键澄清：Skills vs 核心框架

**它们是层级关系，不是重复！**

| 概念 | 定位 | 类比 |
|------|------|------|
| **核心框架** | 底层操作系统 | macOS |
| **Skills** | 应用程序 | 各种 App |

- 核心框架始终运行，控制"怎么思考"
- Skills 按需召唤，提供"谁来做"

---

## 统一入口架构

```
┌────────────────────────────────────────────────────┐
│  Layer 4: 用户输入（自然语言描述任务）              │
└─────────────────────────┬──────────────────────────┘
                          ▼
┌────────────────────────────────────────────────────┐
│  Layer 3.5: 自动路由器（唯一入口）                  │
│  ├─ 关键词检测 → 自动匹配专家                       │
│  ├─ 权重评估 → 决定 Spec-Kit/Task Master           │
│  └─ 模式标志 → 配置 MCP 工具                        │
│                                                    │
│  🔴 用户无需手动调用任何 /命令                      │
└─────────────────────────┬──────────────────────────┘
                          ▼
┌────────────────────────────────────────────────────┐
│  Layer 3: Skills（专家能力）→ WHO 谁来做            │
│  由路由器自动调用，用户不直接操作                   │
└─────────────────────────┬──────────────────────────┘
                          ▼
┌────────────────────────────────────────────────────┐
│  Layer 2: Spec-Kit + Task Master → WHAT + WHEN     │
│  根据权重自动启用                                   │
└─────────────────────────┬──────────────────────────┘
                          ▼
┌────────────────────────────────────────────────────┐
│  Layer 1: 核心框架（始终运行）→ HOW 怎么思考     │
│  RULES.md → MODES.md → FLAGS.md                    │
└────────────────────────────────────────────────────┘
```

---

## 快速决策矩阵

| 任务类型 | 核心框架 | Skills | Task Master | Spec-Kit |
|---------|-------------|--------|-------------|----------|
| 简单 Bug (<3 文件) | ✅ | ✅ 自动 | ❌ | ❌ |
| 复杂 Bug (>3 文件) | ✅ | ✅ 自动 | ✅ | ⚠️ |
| 小功能 (1-2 文件) | ✅ | ✅ 自动 | ❌ | ❌ |
| 新功能 (>5 文件) | ✅ | ✅ 自动 | ✅ | ✅ 强制 |
| 代码分析 | ✅ --think | ✅ 自动 | ❌ | ❌ |
| 重构/API变更 | ✅ | ✅ 自动 | ✅ | ✅ 强制 |

---

## 各层职责

### Layer 1: 核心框架 (始终运行)
**解决**: HOW - 怎么思考

| 组件 | 职责 |
|-----|------|
| RULES.md | 安全规则、强制约束 |
| MODES.md | 思考模式切换 |
| FLAGS.md | 功能标志 |
| MCP_GUIDE.md | MCP 工具路由 |

### Layer 2: Spec-Kit + Task Master
**解决**: WHAT + WHEN

- **Spec-Kit**: 权重 ≥ 7 强制，5 步流程
- **Task Master**: >3 步启用，进度追踪

### Layer 3: Skills (专家能力)
**解决**: WHO - 谁来做

| 专家 | 触发关键词 |
|-----|-----------|
| frontend | React, Vue, CSS, UI, 组件 |
| backend | API, 数据库, 服务端 |
| security | 安全, 漏洞, 认证 |
| performance | 性能, 优化, 卡顿 |
| troubleshoot | Bug, 报错, 不工作 |
| analyze | 分析, 架构, 设计 |

---

## 优先级规则

```
RULES.md 安全规则 > 一切
    ↓
Spec-Kit spec.md > Task Master tasks
    ↓
Skills 专家建议 > 通用执行
    ↓
核心框架模式 > 默认行为
```

---

## 快速记忆

```
核心框架 = 大脑 OS（始终运行，控制思考方式）
Skills      = 专家团队（自动匹配，提供专业知识）
Spec-Kit    = 需求锚点（权重 ≥ 7，防止做偏）
Task Master = 进度看板（>3 步，防止遗漏）
```

**核心原则**：用户只需描述任务，一切自动发生。

---

## 场景示例

详见 `@configs/tool-selection-examples.md`
